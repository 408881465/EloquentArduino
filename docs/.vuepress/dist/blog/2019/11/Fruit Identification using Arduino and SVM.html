<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Fruit Identification using Arduino and SVM | EloquentArduino</title>
    <meta name="description" content="A collection of eloquent APIs for Arduino">
    
    
    <link rel="preload" href="/EloquentArduino/assets/css/0.styles.4405d043.css" as="style"><link rel="preload" href="/EloquentArduino/assets/js/app.0e9dcd18.js" as="script"><link rel="preload" href="/EloquentArduino/assets/js/10.d7732e4c.js" as="script"><link rel="prefetch" href="/EloquentArduino/assets/js/11.c6552ad2.js"><link rel="prefetch" href="/EloquentArduino/assets/js/12.a15c98a1.js"><link rel="prefetch" href="/EloquentArduino/assets/js/2.d8f505d4.js"><link rel="prefetch" href="/EloquentArduino/assets/js/3.9269351e.js"><link rel="prefetch" href="/EloquentArduino/assets/js/4.facae2f5.js"><link rel="prefetch" href="/EloquentArduino/assets/js/5.04cdad08.js"><link rel="prefetch" href="/EloquentArduino/assets/js/6.109e905b.js"><link rel="prefetch" href="/EloquentArduino/assets/js/7.a0893bfc.js"><link rel="prefetch" href="/EloquentArduino/assets/js/8.623902fb.js"><link rel="prefetch" href="/EloquentArduino/assets/js/9.6a2d1977.js">
    <link rel="stylesheet" href="/EloquentArduino/assets/css/0.styles.4405d043.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/EloquentArduino/" class="home-link router-link-active"><!----> <span class="site-name">EloquentArduino</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><!---->  <!----> </div> <div class="page"> <div class="content"><h1 id="fruit-identification-using-arduino-and-svm"><a href="#fruit-identification-using-arduino-and-svm" aria-hidden="true" class="header-anchor">#</a> Fruit Identification using Arduino and SVM</h1> <p>In this post I'm going to replicate the tutorial found on the <a href="https://blog.tensorflow.org/2019/11/fruit-identification-using-arduino-and-tensorflow.html" target="_blank" rel="noopener noreferrer">Tensorflow blog<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
where an Arduino BLE 33 Nano Sense
is used to classify RGB components into colors. Here, however, I'm not using
an Arm Cortex M4 chip: I'll use an Attiny 85 🔥🔥🔥!</p> <p>Since the features are going to be of dimension 3 only (RGB components), my
model is going to be very small (it has 9 support vectors): on my IDE v1.8.9 the compiled code
occupies 1116 bytes (54%) of program space and 13 bytes (10%) of RAM.
Yes, you read it right: <strong>13 bytes of RAM</strong>. Let's take a moment to fully
appreciate this figures; quoting from the official website <code>The core runtime fits in 16 KB on an Arm Cortex M3</code>, and that's without any operator: you will
<strong>NEVER</strong> fit that much code into tiny microcontrollers.</p> <p>Back to the project, the steps are the same as to all machine learning projects:</p> <ol><li>record sample data: put some colored objects in front of your sensor
and record the readings (use a microcontroller with Serial in this stage)</li> <li>train an SVM classifier on your laptop with Python's scikit-learn</li> <li>run <code>svm-porter</code> on the trained classifier</li> <li>copy and include the <code>ml.h</code> file in your Arduino project</li></ol> <p>Now, to run the inference, you just need to pack the RGB components in
a single array and call <code>predict</code>:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token comment">/*********
  @taken_from
  Rui Santos
  Complete project details at http://randomnerdtutorials.com
  The sensor used in a TCS230 or TCS3200
*********/</span>

<span class="token comment">// change to `print(x) Serial.print(x)` during sample recording</span>
<span class="token macro property">#<span class="token directive keyword">define</span> print(x) </span>

<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&quot;ml.h&quot;</span></span>

<span class="token macro property">#<span class="token directive keyword">define</span> S2 1</span>
<span class="token macro property">#<span class="token directive keyword">define</span> S3 2</span>
<span class="token macro property">#<span class="token directive keyword">define</span> sensorOut 3</span>

<span class="token keyword">int</span> red<span class="token punctuation">,</span> green<span class="token punctuation">,</span> blue<span class="token punctuation">;</span>


<span class="token keyword">int</span> <span class="token function">readComponent</span><span class="token punctuation">(</span><span class="token keyword">bool</span> s2<span class="token punctuation">,</span> <span class="token keyword">bool</span> s3<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">digitalWrite</span><span class="token punctuation">(</span>S2<span class="token punctuation">,</span> s2<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">digitalWrite</span><span class="token punctuation">(</span>S3<span class="token punctuation">,</span> s3<span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  <span class="token keyword">int</span> component <span class="token operator">=</span> <span class="token function">pulseIn</span><span class="token punctuation">(</span>sensorOut<span class="token punctuation">,</span> LOW<span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  <span class="token function">print</span><span class="token punctuation">(</span>component<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">'\t'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> component<span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">void</span> <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">pinMode</span><span class="token punctuation">(</span>S2<span class="token punctuation">,</span> OUTPUT<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">pinMode</span><span class="token punctuation">(</span>S3<span class="token punctuation">,</span> OUTPUT<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">pinMode</span><span class="token punctuation">(</span>sensorOut<span class="token punctuation">,</span> INPUT<span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  <span class="token comment">//Serial.begin(115200);</span>
<span class="token punctuation">}</span>


<span class="token keyword">void</span> <span class="token function">loop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  red   <span class="token operator">=</span> <span class="token function">readComponent</span><span class="token punctuation">(</span>LOW<span class="token punctuation">,</span> LOW<span class="token punctuation">)</span><span class="token punctuation">;</span>
  green <span class="token operator">=</span> <span class="token function">readComponent</span><span class="token punctuation">(</span>HIGH<span class="token punctuation">,</span> HIGH<span class="token punctuation">)</span><span class="token punctuation">;</span>
  blue  <span class="token operator">=</span> <span class="token function">readComponent</span><span class="token punctuation">(</span>LOW<span class="token punctuation">,</span> HIGH<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">double</span> features<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> red<span class="token punctuation">,</span> green<span class="token punctuation">,</span> blue <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">uint8_t</span> classIdx <span class="token operator">=</span> <span class="token function">predict</span><span class="token punctuation">(</span>features<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>className <span class="token operator">=</span> <span class="token function">classIdxToName</span><span class="token punctuation">(</span>classIdx<span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">print</span><span class="token punctuation">(</span>className<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>That's it: you deployed machine learning to an Attiny 85 👍. Given the
simplicity of the task, you should easily achieve near 100% accuracy for
different colors (I had some troubles distinguishing orange from yellow
because of the bad illumination).
Just be sure to replicate the exact same setup both during training and classification.</p> <p>I'll paste my generated ml.h file too</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code>
<span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>

<span class="token keyword">double</span> <span class="token function">apply_kernel</span><span class="token punctuation">(</span><span class="token keyword">double</span> <span class="token operator">*</span>x<span class="token punctuation">,</span> <span class="token keyword">double</span> <span class="token operator">*</span>w<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">double</span> kernel <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">uint8_t</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    kernel <span class="token operator">+=</span> x<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> w<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> kernel<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">predict</span><span class="token punctuation">(</span><span class="token keyword">double</span> <span class="token operator">*</span>x<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">double</span> w<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">double</span> kernels<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">double</span> decisions<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> votes<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

    w<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">30.0</span><span class="token punctuation">;</span> w<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">53.0</span><span class="token punctuation">;</span> w<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">25.0</span><span class="token punctuation">;</span>
    kernels<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">apply_kernel</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> w<span class="token punctuation">)</span><span class="token punctuation">;</span>
    w<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">170.0</span><span class="token punctuation">;</span> w<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">258.0</span><span class="token punctuation">;</span> w<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">93.0</span><span class="token punctuation">;</span>
    kernels<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">apply_kernel</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> w<span class="token punctuation">)</span><span class="token punctuation">;</span>
    w<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">157.0</span><span class="token punctuation">;</span> w<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">233.0</span><span class="token punctuation">;</span> w<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">84.0</span><span class="token punctuation">;</span>
    kernels<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">apply_kernel</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> w<span class="token punctuation">)</span><span class="token punctuation">;</span>
    w<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">205.0</span><span class="token punctuation">;</span> w<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">312.0</span><span class="token punctuation">;</span> w<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">105.0</span><span class="token punctuation">;</span>
    kernels<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">apply_kernel</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> w<span class="token punctuation">)</span><span class="token punctuation">;</span>
    w<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">211.0</span><span class="token punctuation">;</span> w<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">303.0</span><span class="token punctuation">;</span> w<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">105.0</span><span class="token punctuation">;</span>
    kernels<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">apply_kernel</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> w<span class="token punctuation">)</span><span class="token punctuation">;</span>
    w<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">211.0</span><span class="token punctuation">;</span> w<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">304.0</span><span class="token punctuation">;</span> w<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">100.0</span><span class="token punctuation">;</span>
    kernels<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">apply_kernel</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> w<span class="token punctuation">)</span><span class="token punctuation">;</span>
    w<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">180.0</span><span class="token punctuation">;</span> w<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">318.0</span><span class="token punctuation">;</span> w<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">104.0</span><span class="token punctuation">;</span>
    kernels<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">apply_kernel</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> w<span class="token punctuation">)</span><span class="token punctuation">;</span>
    w<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">183.0</span><span class="token punctuation">;</span> w<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">328.0</span><span class="token punctuation">;</span> w<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">106.0</span><span class="token punctuation">;</span>
    kernels<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">apply_kernel</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> w<span class="token punctuation">)</span><span class="token punctuation">;</span>
    w<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">176.0</span><span class="token punctuation">;</span> w<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">310.0</span><span class="token punctuation">;</span> w<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">102.0</span><span class="token punctuation">;</span>
    kernels<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">apply_kernel</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> w<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// vote</span>
    decisions<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1.5700826</span>
         <span class="token operator">+</span> kernels<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">3.84e-05</span>
         <span class="token operator">+</span> kernels<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token operator">-</span><span class="token number">3.84e-05</span><span class="token punctuation">;</span>
    decisions<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1.4065215</span>
         <span class="token operator">+</span> kernels<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">1.97e-05</span>
         <span class="token operator">+</span> kernels<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token operator">-</span><span class="token number">1.97e-05</span><span class="token punctuation">;</span>
    decisions<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1.4271657</span>
         <span class="token operator">+</span> kernels<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">2.14e-05</span>
         <span class="token operator">+</span> kernels<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token operator">-</span><span class="token number">2.14e-05</span><span class="token punctuation">;</span>
    decisions<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">11.1926244</span>
         <span class="token operator">+</span> kernels<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0.0005206</span>
         <span class="token operator">+</span> kernels<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token operator">-</span><span class="token number">0.0002205</span> <span class="token operator">+</span> kernels<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token operator">-</span><span class="token number">0.0003001</span><span class="token punctuation">;</span>
    decisions<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">11.8280751</span>
         <span class="token operator">+</span> kernels<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0.0007089</span>
         <span class="token operator">+</span> kernels<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token operator">-</span><span class="token number">0.0007089</span><span class="token punctuation">;</span>
    decisions<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">7.4206153</span>
         <span class="token operator">+</span> kernels<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0.003034</span>
         <span class="token operator">+</span> kernels<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token operator">-</span><span class="token number">0.002586</span> <span class="token operator">+</span> kernels<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token operator">-</span><span class="token number">0.000448</span><span class="token punctuation">;</span>

    votes<span class="token punctuation">[</span>decisions<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    votes<span class="token punctuation">[</span>decisions<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    votes<span class="token punctuation">[</span>decisions<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    votes<span class="token punctuation">[</span>decisions<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    votes<span class="token punctuation">[</span>decisions<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    votes<span class="token punctuation">[</span>decisions<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">2</span> <span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>

    <span class="token keyword">int</span> classVal <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> classIdx <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>votes<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&gt;</span> classVal<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            classVal <span class="token operator">=</span> votes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
            classIdx <span class="token operator">=</span> i<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> classIdx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> <span class="token function">classIdxToName</span><span class="token punctuation">(</span><span class="token keyword">uint8_t</span> classIdx<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>classIdx<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">case</span> <span class="token number">0</span><span class="token operator">:</span>
            <span class="token keyword">return</span> <span class="token string">&quot;none&quot;</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span>
            <span class="token keyword">return</span> <span class="token string">&quot;lemon&quot;</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span>
            <span class="token keyword">return</span> <span class="token string">&quot;grape&quot;</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">3</span><span class="token operator">:</span>
            <span class="token keyword">return</span> <span class="token string">&quot;tomato&quot;</span><span class="token punctuation">;</span>
        <span class="token keyword">default</span><span class="token operator">:</span>
            <span class="token keyword">return</span> <span class="token string">&quot;UNKNOWN&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <div class="page-edit"><!----> <!----></div> <!----> </div> <!----></div></div>
    <script src="/EloquentArduino/assets/js/app.0e9dcd18.js" defer></script><script src="/EloquentArduino/assets/js/10.d7732e4c.js" defer></script>
  </body>
</html>
